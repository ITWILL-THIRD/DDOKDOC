<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.todoc.board.dao.BoardDAO">

 	<!-- ======== 댓글 데이터 처리 ======= -->
	<!-- 게시글에 달린 댓글 데이터 조회 -->
	<select id="getCommentList" parameterType="CommentVO" resultType="CommentVO">
		SELECT C.*, D.NICKNAME, H.HOSIDX
		FROM COMMENTS C
		JOIN DDOKUSER D ON C.USERIDX = D.USERIDX
		LEFT JOIN HOSPITAL H ON C.HOSIDX = H.HOSIDX
		WHERE C.POSTIDX = #{postidx}
		ORDER BY C.COMMENTIDX DESC

	</select>
	
	<!-- 댓글입력 -->
	<insert id="insertComment" parameterType="CommentVO">
		INSERT INTO COMMENTS
		       (COMMENTIDX, USERIDX, HOSIDX, CONTENT, COMMENTDATE, POSTIDX)
		VALUES (SEQ_COMMENTIDX.NEXTVAL, #{useridx}, #{hosidx}, #{content}, SYSDATE, #{postidx})	
	</insert>
	
	<!-- 댓글 삭제(댓글번호 사용) -->
	<delete id="deleteComment" parameterType="CommentVO">
		DELETE FROM COMMENTS WHERE COMMENTIDX = #{commentidx}
	</delete>
  
</mapper>